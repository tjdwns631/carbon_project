<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="carbon.mapper.BoardMapper">

	<resultMap type="carbon.dto.MemberDto" id="MemberDto">
		<id column="MEMBER_IDX" property="member_idx" />
		<result column="MEMBER_ID" property="member_id" />
		<result column="MEMBER_PWD" property="member_pwd" />			
		<result column="MEMBER_NAME" property="member_name" />
	</resultMap>
	
	<resultMap type="carbon.dto.Tb_categoryDto" id="Tb_categoryDto">
		<id column="CATE_IDX" property="cate_idx" />
		<result column="CATE_NAME" property="cate_name" />
	</resultMap>
	
	<resultMap type="carbon.dto.BoardDto" id="BoardDto">
		<id column="BOARD_IDX" property="board_idx" />
		<result column="BOARD_TITLE" property="board_title" />
		<result column="BOARD_CONTENT" property="board_content" />
		<result column="CATE_IDX" property="cate_idx" />
		<result column="BOARD_PWD" property="board_pwd" />
		<result column="MEMBER_IDX" property="member_idx" />
		<result column="BOARD_HITS" property="board_hits" />
		<result column="BOARD_DATE" property="board_date" />
		<result column="BOARD_UPD" property="board_upd" />
		<collection property="memberdto" resultMap="MemberDto" />
		<collection property="tb_categorydto" resultMap="Tb_categoryDto" />
	</resultMap>
	
	<!-- 게시물 리스트 -->
	<select id="board_list" parameterType="carbon.dto.BoardDto" resultMap="BoardDto">
		SELECT a.board_idx board_idx, a.board_title board_title, a.cate_idx cate_idx, b.cate_name cate_name, a.member_idx member_idx,
		 c.member_name member_name, a.board_hits board_hits, a.board_date board_date
		FROM tb_board a JOIN tb_category b ON a.cate_idx = b.cate_idx
		JOIN tb_member c ON c.member_idx = a.member_idx
		ORDER BY a.board_idx DESC
	</select>
	
	<!-- 총 게시물 수 -->
	<select id="board_total" resultType="Integer"> 
		SELECT count(*) FROM tb_board 
	</select>

</mapper>